<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <link rel="shortcut icon" href="../assets/logo-army.png" type="image/x-icon">
    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
    <script src="../js/funcoes.js"></script>
    <title>Homepage</title>
</head>

<body onload="validarSessao()">
    <div class="container">
        <div class="navBar">
            <div class="profile">
                <img src="../assets/profile/profile1.png" alt="foto perfil">
                <span id="username">username</span>
            </div>
            <div class="menu-navegacao">
                <ul>
                    <li id="opcao_nav"><a href="home.html">home</a></li>
                    <li id="opcao_nav">perfil</li>
                    <li id="opcao_nav"><a href="quizdash.html">quizz</a></li>
                    <li id="opcao_nav"><a href="">dashboardz</a></li>
                    <li id="opcao_nav" onclick="logout()">logout</li>
                </ul>
            </div>
        </div>
        <div class="dash-quizz">
            <h1 id="quizz1">Conhecimento sobre trajetoria</h1>

            <div class="quizz-musica" id="musica_1">
                <h1>musica 1 / 5</h1>
                <div class="musica">
                    <audio controls autoplay>
                        <source src="../assets/audios/attackonbangtan.mp4" type="audio/mpeg">
                    </audio>
                    <h5>Dica: uma das primeiras músicas que marcam o inicio da carreira</h5>
                    <span class=respostas>
                        <input type="text" id="R_Q1" placeholder="Digite seu palpite">
                    </span>
                </div>
                <span class="botoes">
                    <button onclick="avancar()">Proxima</button>
                </span>
            </div>
            <!-- musica 2 -->
            <div class="quizz-musica" id="musica_2">
                <h1>musica 2 / 5</h1>
                <div class="musica">
                    <audio controls autoplay>
                        <source src="../assets/audios/dynamitebts.mp4" type="audio/mpeg">
                    </audio>
                    <h5>Dica: foi a primeira música do BTS a atingir 1 bilhão de visualizações no YouTube?</h5>
                    <span class=respostas>
                        <input type="text" id="R_Q2" placeholder="Digite seu palpite">
                    </span>
                </div>
                <span class="botoes">
                    <button onclick="retornar()">Voltar</button>
                    <button onclick="avancar()">Proxima</button>
                </span>
            </div>
            <!-- musica 3 -->
            <div class="quizz-musica" id="musica_3">
                <h1>musica 3 / 5</h1>
                <div class="musica">
                    <audio controls autoplay>
                        <source src="../assets/audios/holdmetight.mp4" type="audio/mpeg">
                    </audio>
                    <h5>Dica: uma das intros mais marcantes da triologia HYYH.</h5>
                    <span class=respostas>
                        <input type="text" id="R_Q3" placeholder="Digite seu palpite">
                    </span>
                </div>
                <span class="botoes">
                    <button onclick="retornar()">Voltar</button>
                    <button onclick="avancar()">Proxima</button>
                </span>
            </div>
            <!-- musica 4 -->
            <div class="quizz-musica" id="musica_4">
                <h1>musica 4 / 5</h1>
                <div class="musica">
                    <audio controls autoplay>
                        <source src="../assets/audios/airplane.mp4" type="audio/mpeg">
                    </audio>
                    <h5>Dica: É a continuação de uma das músicas solo do grupo.</h5>
                    <span class=respostas>
                        <input type="text" id="R_Q4" placeholder="Digite seu palpite">
                    </span>
                </div>
                <span class="botoes">
                    <button onclick="retornar()">Voltar</button>
                    <button onclick="avancar()">Proxima</button>
                </span>
            </div>
            <!-- musica 5 -->
            <div class="quizz-musica" id="musica_5">
                <h1>musica 5 / 5</h1>
                <div class="musica">
                    <audio controls autoplay>
                        <source src="../assets/audios/btsjump.mp4" type="audio/mpeg">
                    </audio>
                    <h5>Dica: Uma música marcada pela sua caracteristica 'pulante'.</h5>
                    <span class=respostas>
                        <input type="text" id="R_Q5" placeholder="Digite seu palpite">
                    </span>
                </div>
                <span class="botoes">
                    <button onclick="retornar()">Voltar</button>
                    <button onclick="finalizar()">Finalizar</button>
                </span>
            </div>
            <!-- Resultado 5 -->
            <div class="quizz-musica" id="tela_final">
                <h1>Resultado</h1>
                <img src="../assets/resultados-quiz1.png">
                <h4>Você acertou <span id='resultado'>x</span> questões</h4>
                <span class=respostas>
                    <button onclick="refazer()">Refazer</button>
                    <button onclick="salvar()">Salvar resultado</button>
                </span>
            </div>
        </div>

</body>

</html>
<script>
    musica_1.style.display = "flex";
    function logout() {
        sessionStorage.clear()
        window.location = "../index.html";
    }
    var pontos = 0;
    var answer = ['ATTACK ON BANGTAN', 'DYNAMITE', 'HOLD ME TIGHT', 'AIRPLANE PT2', 'JUMP']
    var resposta1 = ""
    var resposta2 = ""
    var resposta3 = ""
    var resposta4 = ""
    var resposta5 = ""
    var manipulado = ""
    function avancar() {
        var validacao5 = resposta5 != ""

        if (musica_1.style.display === "flex") {
            resposta1 = R_Q1.value
            if (resposta1 != "") {
                manipulado = resposta1.toUpperCase()
                if (answer[0] == manipulado) {
                    pontos++
                }
                musica_1.style.display = "none";
                musica_2.style.display = "flex";
            } else {
                alert(`Digite uma resposta antes de prosseguir`)
            }
        } else if (musica_2.style.display === "flex") {
            resposta2 = R_Q2.value
            if (validacao2 = resposta2 != "") {
                manipulado = resposta2.toUpperCase()
                if (answer[1] == manipulado) {
                    pontos++
                }
                musica_2.style.display = "none";
                musica_3.style.display = "flex";
            } else {
                alert(`Digite uma resposta antes de prosseguir`)
            }
        } else if (musica_3.style.display === "flex") {
            resposta3 = R_Q3.value
            if (resposta3 != "") {
                manipulado = resposta3.toUpperCase()
                if (answer[2] == manipulado) {
                    pontos++
                }
                musica_3.style.display = "none";
                musica_4.style.display = "flex";
            } else {
                alert(`Digite uma resposta antes de prosseguir`)
            }
        } else if (musica_4.style.display === "flex") {
            resposta4 = R_Q4.value
            if (resposta4 != "") {
                manipulado = resposta4.toUpperCase()
                if (answer[3] == manipulado) {
                    pontos++
                }
                musica_4.style.display = "none";
                musica_5.style.display = "flex";
            } else {
                alert(`Digite uma resposta antes de prosseguir`)
            }
        }
    }

    function finalizar() {
        resposta5 = R_Q5.value
        if (resposta5 != "") {
            manipulado = resposta5.toUpperCase()
            if (answer[4] == manipulado) {
                pontos++
            }
            musica_5.style.display = "none";
            tela_final.style.display = "flex";
            resultado.innerHTML = pontos
        } else {
            alert(`Digite uma resposta antes de prosseguir`)
        }
    }


    function refazer() {
        pontos = 0;
        musica_1.style.display = "flex";
        musica_2.style.display = "none";
        musica_3.style.display = "none";
        musica_4.style.display = "none";
        musica_5.style.display = "none";
        tela_final.style.display = "none";
        resposta1 = ``
        resposta2 = ``
        resposta3 = ``
        resposta4 = ``
        resposta5 = ``
        manipulado = ``
        R_Q1.value = ``
        R_Q2.value = ``
        R_Q3.value = ``
        R_Q4.value = ``
        R_Q5.value = ``
    }

    function salvar() {
        var usernameVar = sessionStorage.username_USUARIO;
        fetch("/usuarios/resultadoquizdois", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                // crie um atributo que recebe o valor recuperado aqui
                // Agora vá para o arquivo routes/usuario.js
                pontosServer: pontos,
                usernameServer: usernameVar
            })
        }).then(function (resposta) {

            console.log("resposta: ", resposta);

            if (resposta.ok) {
                alert(`Foi registrada a pontuação de ${pontos}`);
                finalizarAguardar();
                refazer();
                setTimeout(() => {
                    window.location = "logado/quizdash.html";
                }, "2000")

                finalizarAguardar();
            } else {
                throw ("Houve um erro ao tentar realizar o cadastro!");
            }
        }).catch(function (resposta) {
            console.log(`#ERRO: ${resposta}`);
            // finalizarAguardar();
        });

        return false;
    }

    function sumirMensagem() {
        // mensagem_erro.innerHTML = ``;
    }

</script>